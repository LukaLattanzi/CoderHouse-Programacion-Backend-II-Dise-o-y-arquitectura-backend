# Introducción, Patrones de Persistencia y Conexión a la Lógica de Negocio

## Introducción a la Arquitectura del Servidor: Patrones de Persistencia

En la arquitectura de un servidor backend, la **persistencia de datos** es fundamental para mantener la integridad y flexibilidad de una aplicación. Los patrones de persistencia como **DAO** (Data Access Object), **Factory**, **DTO** (Data Transfer Object) y **Repository** son esenciales para lograr una estructura organizada y escalable. Estos patrones permiten desacoplar la lógica de negocio del acceso a los datos, facilitando su mantenimiento y adaptación.

---

## Patrones de Persistencia

### DAO (Data Access Object)

- **Propósito:** Abstrae y encapsula el acceso a la fuente de datos. Permite realizar operaciones CRUD (Create, Read, Update, Delete) sin que la lógica de negocio se vea afectada por los detalles de la fuente de datos.
- **Implementación:** Se crean diferentes DAOs para manejar diversas fuentes de datos, como bases de datos, archivos o memoria. Por ejemplo, un `MongoDAO` manejará la persistencia en MongoDB, mientras que un `MemoryDAO` lo hará en memoria.
- **Beneficios:** Facilita el cambio de la fuente de datos sin alterar la lógica del negocio, mejorando la flexibilidad del sistema.

---

### Factory

- **Propósito:** Dinamiza la selección de la persistencia adecuada según la configuración o entorno de la aplicación.
- **Implementación:** A través de un archivo `factory.js`, se selecciona y retorna el DAO correspondiente basado en una variable de entorno. Esto elimina la necesidad de cambiar manualmente los imports en el código.
- **Beneficios:** Permite cambiar la persistencia de manera sencilla y dinámica, ideal para entornos de desarrollo y producción.

---

### DTO (Data Transfer Object)

- **Propósito:** Gestiona y transforma los datos entre la aplicación y la fuente de datos. Es útil cuando los datos del cliente y la base de datos no coinciden exactamente.
- **Implementación:** Un DTO puede modificar la estructura de los datos antes de ser enviados al DAO o transformarlos al ser devueltos al cliente. Por ejemplo, puede unir `first_name` y `last_name` en un `fullName` antes de almacenarlo.
- **Beneficios:** Asegura la consistencia de los datos y facilita la gestión de cambios en la estructura de datos entre la lógica de negocio y la persistencia.

---

### Repository

- **Propósito:** Añade una capa adicional que actúa como intermediario entre la lógica de negocio y los DAOs. Se encarga de llamar a los métodos del DAO y aplicar cualquier lógica adicional necesaria.
- **Implementación:** Un Repository encapsula el uso de los DAOs y puede integrar DTOs para mantener los datos correctamente formateados sin que la lógica de negocio tenga que preocuparse por ello.
- **Beneficios:** Mejora la claridad y separación de responsabilidades, facilitando la escalabilidad y mantenibilidad del código.

---

## Implementación del DAO

Un ejemplo práctico es la creación de un DAO para manejar diferentes fuentes de datos, como MongoDB y memoria:

1. **Definir el DAO:** Crear un archivo para cada fuente de datos (por ejemplo, `MongoDAO.js`, `MemoryDAO.js`) con métodos homologados como `get()`, `save()`, `update()`, etc.
2. **Integrar el DAO en la Lógica de Negocio:** En la lógica de negocio, se importa el DAO necesario y se utilizan sus métodos para manipular los datos.
3. **Cambiar de Fuente de Datos:** Para cambiar la fuente de datos, solo es necesario intercambiar el DAO importado, sin modificar el resto de la lógica de negocio.

---

## Conclusión

Los patrones de persistencia como **DAO**, **Factory**, **DTO** y **Repository** permiten una arquitectura de servidor más modular, flexible y fácil de mantener. Al implementar estos patrones, se logra desacoplar la lógica de acceso a datos de la lógica de negocio, mejorando la organización y escalabilidad del código.

# Guía para Integrar JWT en una Aplicación Express

La integración de **JWT (JSON Web Tokens)** en una aplicación Express permite manejar la autenticación sin estado de manera segura y eficiente. A continuación, se detalla cómo crear tokens JWT, verificarlos en el servidor y aplicarlos en las rutas de registro y login, con explicaciones paso a paso.

---

## Paso 1: Configuración Inicial y Dependencias

1. **Requisitos previos:**  
   Asegúrate de tener Node.js y npm instalados en tu sistema.

2. **Inicializa el proyecto y agrega dependencias:**

   ```bash
   npm init -y
   npm install express jsonwebtoken bcryptjs body-parser
   ```

3. **Estructura básica del servidor:**  
   Crea un archivo `server.js` con la configuración básica del servidor y la clave secreta para firmar los JWT.
   > **Nota:** En este ejemplo, los usuarios se almacenan en memoria. En producción, usa una base de datos.

---

## Paso 2: Creación de la Ruta de Registro

- Permite a los nuevos usuarios crear una cuenta.
- Las contraseñas se cifran usando **bcrypt** antes de almacenarse.

**Flujo:**

1. Recibe los datos del usuario.
2. Verifica si el usuario ya existe.
3. Si no existe, cifra la contraseña y almacena el usuario.
4. Devuelve un mensaje de éxito.

> **Explicación:**  
> Se evita el registro de usuarios duplicados y se protege la contraseña mediante cifrado.

---

## Paso 3: Creación de la Ruta de Login y Generación de Tokens JWT

- Permite a los usuarios autenticarse.
- Si las credenciales son correctas, se genera un JWT y se envía al cliente.

**Flujo:**

1. Recibe las credenciales.
2. Verifica existencia del usuario y validez de la contraseña.
3. Si es exitoso, genera un JWT con expiración definida y lo devuelve.

> **Explicación:**  
> El JWT contiene información del usuario y una expiración que define su validez.

---

## Paso 4: Verificación de Tokens y Protección de Rutas

- Se utiliza un **middleware** para verificar la validez del JWT en cada solicitud.

**Flujo:**

1. El middleware extrae el token de los headers.
2. Verifica el token usando la clave secreta.
3. Si es válido, permite continuar; si no, devuelve un error de acceso denegado.

- Aplica este middleware a las rutas que requieren autenticación.

> **Explicación:**  
> Solo las solicitudes con un token válido pueden acceder a rutas protegidas, asegurando la autenticidad de cada solicitud.

---

## Paso 5: Prueba del Sistema

1. **Registro:**  
   Envía los datos a la ruta de registro y verifica que la contraseña se cifra correctamente.

2. **Login:**  
   Inicia sesión y verifica que el servidor genera y devuelve un JWT.

3. **Acceso a rutas protegidas:**  
   Usa el token JWT recibido en el login, incluyéndolo en los headers de la solicitud.

---

## Conclusión

Integrar JWT en una aplicación Express proporciona un método seguro y escalable para gestionar la autenticación sin estado. Los tokens permiten a los usuarios autenticarse de forma persistente y acceder a recursos protegidos sin que el servidor mantenga sesiones tradicionales.

Esta guía cubre los pasos básicos para configurar JWT, proteger rutas y verificar la autenticidad de las solicitudes en aplicaciones web modernas, garantizando la seguridad de la aplicación y de los datos de los usuarios.

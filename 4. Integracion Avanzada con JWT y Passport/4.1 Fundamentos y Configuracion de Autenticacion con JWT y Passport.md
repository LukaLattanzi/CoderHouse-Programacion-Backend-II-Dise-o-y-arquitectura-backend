# Introducción a los Objetivos de la Clase: Integración de JWT con Passport

En esta unidad, nos enfocaremos en la integración de **JWT (JSON Web Tokens)** con **Passport**, un middleware de autenticación para Node.js que facilita la implementación de diversas estrategias de autenticación en aplicaciones Express.  
El objetivo principal es aprender cómo utilizar JWT con Passport para gestionar la autenticación sin estado, protegiendo las rutas de la aplicación y manteniendo la seguridad de las solicitudes.

---

## Objetivos de la Clase

- **Comprender la Integración de JWT con Passport:**  
   Aprenderemos cómo configurar y utilizar Passport para manejar la autenticación basada en JWT, facilitando la gestión de usuarios y la protección de rutas en la aplicación.

- **Explorar las Formas de Enviar JWT:**  
   Analizaremos las diferentes formas de enviar los tokens JWT desde el cliente al servidor, centrándonos en las dos más comunes: a través de los _headers_ de autorización y mediante _cookies_.

- **Comparar Métodos de Envío de JWT:**  
   Evaluaremos las ventajas, desventajas y consideraciones de seguridad de cada método de envío de JWT, para comprender cuál es el más adecuado en diferentes contextos.

---

## Formas de Enviar JWT: Headers de Autorización vs Cookies

Los JWT se pueden enviar de varias formas, siendo los métodos más comunes el uso de _headers_ de autorización y el uso de _cookies_. Ambos métodos tienen aplicaciones específicas y presentan distintas implicaciones en términos de seguridad y facilidad de implementación.

### 1. Envío de JWT a través de Headers de Autorización

En este método, el JWT se envía en el header `Authorization` de cada solicitud HTTP. Es el enfoque más directo y se basa en el uso de tokens tipo **Bearer**.

**Ventajas:**

- **Simplicidad y Control:**  
   Los tokens se envían de manera explícita con cada solicitud, lo que da al cliente un control claro sobre el envío del token.

- **Desacoplamiento del Estado de Sesión:**  
   Ideal para aplicaciones RESTful que no desean mantener el estado de la sesión en el servidor.

- **Facilidad de Integración:**  
   Es fácil de implementar con estrategias de autenticación como Passport, y funciona bien con clientes como aplicaciones web y móviles.

**Desventajas:**

- **Exposición a XSS (Cross-Site Scripting):**  
   Si un atacante consigue acceso al código JavaScript de la aplicación, podría extraer los tokens del almacenamiento local.

- **Falta de Seguridad Adicional por Defecto:**  
   Los tokens en headers no cuentan con las protecciones adicionales que las cookies pueden ofrecer (como el flag `HttpOnly`).

**Consideraciones de Seguridad:**

- **Almacenamiento Seguro:**  
   Los tokens deben almacenarse en un lugar seguro como la memoria de la aplicación o el almacenamiento seguro del navegador, no en _local storage_, para mitigar ataques XSS.

- **Uso de HTTPS:**  
   Siempre se debe usar HTTPS para proteger la transmisión de tokens y evitar ataques de interceptación (_man-in-the-middle_).

---

### 2. Envío de JWT a través de Cookies

En este método, el JWT se almacena en una _cookie_ y se envía automáticamente con cada solicitud HTTP al servidor.

**Ventajas:**

- **Protección Contra XSS:**  
   Las cookies pueden tener el atributo `HttpOnly`, que evita que el token sea accesible desde el código JavaScript, reduciendo el riesgo de ataques XSS.

- **Facilidad de Envío Automático:**  
   Las cookies se envían automáticamente con cada solicitud, lo que simplifica la gestión del envío del token desde el cliente al servidor.

- **Configuración de Seguridad Adicional:**  
   Las cookies pueden configurarse con los flags `Secure` (solo enviadas a través de HTTPS) y `SameSite` (previene ataques CSRF), lo que añade capas adicionales de seguridad.

**Desventajas:**

- **Exposición a CSRF (Cross-Site Request Forgery):**  
   Las cookies se envían automáticamente con cada solicitud, lo que puede ser explotado en ataques CSRF si no se toman medidas adecuadas como la configuración de `SameSite`.

- **Complejidad de Manejo:**  
   Requiere una configuración más cuidadosa del lado del servidor para gestionar los flags de seguridad y evitar vulnerabilidades.

**Consideraciones de Seguridad:**

- **Configurar Flags de Seguridad:**  
   Utilizar `HttpOnly`, `Secure`, y `SameSite` para proteger los tokens de ataques comunes.

- **Mitigar CSRF:**  
   Implementar medidas de protección como tokens CSRF para asegurar que solo las solicitudes legítimas provengan de usuarios autenticados.

---

## Conclusión

La integración de JWT con Passport permite una gestión flexible y segura de la autenticación en aplicaciones web.  
Comprender las diferencias entre los métodos de envío de JWT a través de _headers_ de autorización y _cookies_ es crucial para seleccionar la estrategia más adecuada según las necesidades de la aplicación y el entorno de seguridad requerido.  
Ambas opciones ofrecen ventajas y desventajas, y deben implementarse con consideraciones de seguridad para garantizar la protección de los datos del usuario y la integridad de las solicitudes.
